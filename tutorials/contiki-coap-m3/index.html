
<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.iot-lab.info/tutorials/contiki-coap-m3/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jun 2020 08:21:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<!-- [if IE]> <meta http-equiv="X-UA-Compatible" content="IE=Edge"/> <! [endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="../../xmlrpc.php" />
<title>CoAP server with public IPv6 network and M3 nodes &#8226; FIT/IoT-LAB</title>
<!--[if lt IE 9]><script src="https://www.iot-lab.info/wp-content/themes/alienship-1.2.5/js/html5shiv.js" type="text/javascript"></script><![endif]-->

<link rel="alternate" type="application/rss+xml" title="FIT/IoT-LAB &raquo; Feed" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="FIT/IoT-LAB &raquo; Comments Feed" href="../../comments/feed/index.html" />
<link rel='stylesheet' id='responsive-lightbox-swipebox-front-css'  href='../../wp-content/plugins/responsive-lightbox/assets/swipebox/source/swipebox2f54.css?ver=4.1' type='text/css' media='all' />
<link rel='stylesheet' id='toc-screen-css'  href='../../wp-content/plugins/table-of-contents-plus/screen6149.css?ver=1404' type='text/css' media='all' />
<link rel='stylesheet' id='parent-style-css'  href='../../wp-content/themes/alienship-1.2.5/style2f54.css?ver=4.1' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='../../wp-content/themes/alienship-1.2.5/css/bootstrap.minb3e8.css?ver=0.1' type='text/css' media='all' />
<link rel='stylesheet' id='alienship-style-css'  href='../../wp-content/themes/alienship-1.2.5-child/styleb3e8.css?ver=0.1' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery90f9.js?ver=1.11.1'></script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery-migrate.min1576.js?ver=1.2.1'></script>
<script type='text/javascript' src='../../wp-content/plugins/responsive-lightbox/assets/swipebox/source/jquery.swipebox.min2f54.js?ver=4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var rlArgs = {"script":"swipebox","selector":"lightbox","custom_events":"","activeGalleries":"1","animation":"1","hideBars":"1","hideBarsDelay":"5000","videoMaxWidth":"1080"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/responsive-lightbox/js/front2f54.js?ver=4.1'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5-child/js/bootstrap-hover-dropdown.min2f54.js?ver=4.1'></script>
<link rel='canonical' href='index.html' />
        <style type="text/css" media="screen">
          div.printfriendly {
            margin: 12px 12px 12px 12px;;
          }
          div.printfriendly a, div.printfriendly a:link, div.printfriendly a:visited {
            text-decoration: none;
            font-size: 14px;
            color: #6D9F00;
            vertical-align: bottom;
            border: none;
          }

          .printfriendly a:hover {
            cursor: pointer;
          }

          .printfriendly a img  {
            border: none;
            padding:0;
            margin-right: 6px;
            display:inline-block;
            box-shadow: none;
            -webkit-box-shadow: none;
            -moz-box-shadow: none;
          }
          .printfriendly a span{
            vertical-align: bottom;
          }
          .pf-alignleft {
            float: left;
          }
          .pf-alignright {
            float: right;
          }
          div.pf-aligncenter {
            display: block;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
          }
        </style>
        <style type="text/css" media="print">
          .printfriendly {
            display: none;
          }
        </style>
 	<style type="text/css">
 				#site-title,
		#site-description {
			position: absolute;
			clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
			clip: rect(1px, 1px, 1px, 1px);
		}
 		 	</style>
 	
<!-- BEGIN GADWP v5.3.1.1 Universal Analytics - https://deconf.com/google-analytics-dashboard-wordpress/ -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-115966924-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- END GADWP Universal Analytics -->
</head>

<body class="page page-id-7399 page-child parent-pageid-7210 page-template-default layout-1c">
	<!--[if lt IE 9]><p class="browsehappy alert alert-danger">You are using an outdated browser. Please <a class="alert-link" href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]-->

	<!-- Top Menu -->
	<nav class="navbar navbar-default navbar-onelab navbar-fixed-top top-navigation" role="navigation">
	    <div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
							<a href="../../index.html"><img src="../../wp-content/themes/alienship-1.2.5-child/templates/parts/fit-iotlab3.png" /></a>
					</div>

		<div class="collapse navbar-collapse navbar-ex1-collapse">
			<ul id="menu-topmainmenu" class="nav navbar-nav"><li id="menu-item-2066" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2066"><a title="News" href="../../news/index.html">News</a></li>
<li id="menu-item-140" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-140 dropdown"><a title="Platform" data-toggle="dropdown" data-hover="dropdown" href="../../what-is-iot-lab/index.html">Platform <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-466" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-466"><a title="What is IoT-LAB?" href="../../what-is-iot-lab/index.html">What is IoT-LAB?</a></li>
	<li id="menu-item-147" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-147"><a title="Deployment" href="../../deployment/index.html">Deployment</a></li>
	<li id="menu-item-146" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-146"><a title="Hardware" href="../../hardware/index.html">Hardware</a></li>
	<li id="menu-item-4608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4608"><a title="Robots" href="../../robots/index.html">Robots</a></li>
	<li id="menu-item-2400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2400"><a title="About us" href="../../about-us/index.html">About us</a></li>
</ul>
</li>
<li id="menu-item-1467" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1467 dropdown"><a title="Dev Center" data-toggle="dropdown" data-hover="dropdown" href="../../dev-center/index.html">Dev Center <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-1957" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1957"><a title="Software Development" href="../../dev-center/index.html">Software Development</a></li>
	<li id="menu-item-7329" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-7329"><a title="Tutorials" href="../index.html">Tutorials</a></li>
	<li id="menu-item-1552" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1552"><a title="Operating Systems" href="../../operating-systems/index.html">Operating Systems</a></li>
	<li id="menu-item-1396" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1396"><a title="Libraries" href="../../libraries/index.html">Libraries</a></li>
	<li id="menu-item-1394" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1394"><a title="Drivers" href="../../drivers/index.html">Drivers</a></li>
	<li id="menu-item-7372" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7372"><a title="REST API documentation" href="http://api.iot-lab.info/">REST API documentation</a></li>
</ul>
</li>
<li id="menu-item-3209" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3209 dropdown"><a title="Community" data-toggle="dropdown" data-hover="dropdown" href="../../community/index.html">Community <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-3244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3244"><a title="Share your experience" href="../../community/index.html">Share your experience</a></li>
	<li id="menu-item-3210" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3210"><a title="Education" href="../../education/index.html">Education</a></li>
	<li id="menu-item-2133" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2133"><a title="Publications" href="../../publications/index.html">Publications</a></li>
	<li id="menu-item-2405" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2405"><a title="Charter" href="../../charter/index.html">Charter</a></li>
</ul>
</li>
<li id="menu-item-1470" class="get_started menu-item menu-item-type-post_type menu-item-object-page menu-item-1470"><a title="Get Started" href="../../get_started/index.html">Get Started</a></li>
</ul>

			<ul class="nav navbar-nav navbar-right">

				<li class="dropdown">
					<a href="../../testbed/drawgantt.html" title="Testbed activity"><span class="glyphicon glyphicon-calendar"></span> Activity</a>
				</li>



			                        	<li><span><a href="../../testbed/index.html" class="btn btn-primary testbed" title="Login">Access the testbed</a></span></li>
			                        </ul>
		</div>
	    </div>
	</nav>
<!-- End Top Menu -->


	<div id="page" class="container hfeed site">

				<header id="masthead" class="site-header" role="banner">
			<p id="site-title" class="site-title"><a href="../../index.html" title="FIT/IoT-LAB" rel="home">FIT/IoT-LAB</a></p><p id="site-description" class="site-description">Very large scale open wireless sensor network testbed</p>		</header><!-- #masthead -->
			<div id="content" class="site-content row">

	
	<div id="primary" class="content-area col-sm-8">

				<main id="main" class="site-main" role="main">

			<article role="article" id="post-7399" class="post-7399 page type-page status-publish hentry">
		<div class="entry-content">
		<div class="pf-content"><h2>CoAP server with public IPv6/RPL/6LoWPAN network</h2>
<p>&nbsp;</p>
<p><img class="alignnone size-full wp-image-1252" src="../../wp-content/uploads/2014/02/difficulty.jpg" alt="" width="30" height="30" /> <strong>Difficulty</strong>: High</p>
<p><img class="size-full wp-image-1253 alignnone" src="../../wp-content/uploads/2014/02/duration.jpg" alt="" width="30" height="30" /> <strong>Duration</strong>: 90 minutes</p>
<p><em><strong>Prerequisites</strong>: <a href="../ssh-access/index.html" target="_blank">Configure SSH Access</a> / <a title="Get and compile firmware for M3 and A8-M3 nodes" href="../contiki-compilation/index.html">Get and compile firmware for M3 and A8-M3 nodes</a> / <a href="../understand-ipv6-subnetting-on-the-fit-iot-lab-testbed/index.html" target="_blank">Understand IPv6 subnetting</a> / <a href="../contiki-public-ipv6-m3/index.html" target="_blank">Public IPv6/6LoWPAN/RPL network with M3 nodes</a></em></p>
<p><em><strong>Description</strong>: The aim of this tutorial is to discover the basics of Constrained Application Protocol (<strong>CoAP</strong>) . You will reserve some M3 nodes on the Grenoble site, set them up with flashing two firmwares nodes, and create a simple IPv6 network in IoT-LAB. You will access nodes over IPv6 using a Contiki tunslip6 bridge and launch requests on a CoAP Contiki Erbium server implementation.</em></p>
<ol>
<li><a href="../../testbed/index.html" target="_blank">Log into the Web portal</a> with your account credentials</li>
<li>Submit a new experiment:
<ul>
<li>Set an experiment name (no spaces nor funny chars in the experiment name)</li>
<li>Duration: <strong>60 minutes</strong> and starting &#8220;<strong>As soon as possible</strong>&#8220;</li>
<li>Choose ten nodes with Architecture m3 (at86rf231) / Site = grenoble / Number = 10 and click &#8220;Add to experiment&#8221;</li>
</ul>
</li>
<li>Wait experiment state Running in the Schedule dashboard section. After click on experiment details and visualize which nodes you are booked and verify that you have Success in the deployment result</li>
<li>Compile firmwares on SSH frontend.
<pre>my_computer$ ssh &lt;login&gt;@grenoble.iot-lab.info</pre>
<ul>
<li><strong>Border Router</strong>: bridge between the server and the IoT-LAB IPv6 network
<pre>&lt;login&gt;@grenoble:~$ cd ~/iot-lab/parts/contiki/examples/ipv6/rpl-border-router</pre>
<p>Optionnal : setup CHANNEL and PANID, edit <strong>project-conf.h</strong>		</p>
<pre>
#ifndef PROJECT_ROUTER_CONF_H_
#define PROJECT_ROUTER_CONF_H_

#undef RF2XX_CHANNEL
#define RF2XX_CHANNEL                     <strong>11</strong>
#undef IEEE802154_CONF_PANID
#define IEEE802154_CONF_PANID          <strong>0x0001</strong>
</pre>
<p>Compile for iotlab-m3 target</p>
<pre>
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/ipv6/rpl-border-router$ make TARGET=iotlab-m3
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/ipv6/rpl-border-router$ ls
... <strong>border-router.iotlab-m3</strong> ...
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/ipv6/rpl-border-router$ cp border-router.iotlab-m3 ~/
</pre>
</li>
</ul>
<ul>
<li><strong>IoT-LAB version of CoAP Erbium server</strong>:
<pre>&lt;login&gt;@grenoble:~$ cd ~/iot-lab/parts/contiki/examples/iotlab/04-er-rest-example</pre>
<p>Optionnal : setup CHANNEL and PANID, edit <strong>project-conf.h</strong>		</p>
<pre>
#ifndef __PROJECT_ERBIUM_CONF_H__
#define __PROJECT_ERBIUM_CONF_H__

/* Custom channel and PAN ID configuration for your project. */
#undef RF2XX_CHANNEL
#define RF2XX_CHANNEL                     <strong>11</strong>

#undef IEEE802154_CONF_PANID
#define IEEE802154_CONF_PANID          <strong>0x0001</strong>
</pre>
<p>Compile for iotlab-m3 target</p>
<pre>
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/04-er-rest-example$ make TARGET=iotlab-m3
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/04-er-rest-example$ ls
... <strong>er-example-server.iotlab-m3</strong> ...
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/04-er-rest-example$ cp er-example-server.iotlab-m3 ~/
</pre>
</li>
</ul>
<p>View <a href="https://github.com/iot-lab/contiki/tree/master/examples/ipv6/rpl-border-router" target="_blank">Border Router</a> and <a href="https://github.com/iot-lab/contiki/tree/master/examples/iotlab/04-er-rest-example" target="_blank">CoAP Server</a> source code on GitHub.</li>
<li>Choose an <a href="../understand-ipv6-subnetting-on-the-fit-iot-lab-testbed/index.html" target="_blank">available IPv6 prefix</a> for the site you are experimenting on. For example in Grenoble testbed :
<ul>
<li>we choose <strong>2001:660:5307:3100::/64</strong></li>
</ul>
</li>
<li>Choose one node in your nodes list to implement the Border Router (BR) node
<ul>
<li>we choose node <strong>m3-1</strong></li>
</ul>
</li>
<li>Start tunslip6 on the SSH frontend:
<ul>
<li>
<pre>&lt;login&gt;@grenoble:~$ sudo tunslip6.py -v2 -L -a m3-1 -p 20000 2001:660:5307:3100::1/64
slip connected to ``172.16.10.1:20000''

15:38:19 opened tun device ``/dev/tun0''
0000.000 ifconfig tun0 inet `hostname` up
0000.004 ifconfig tun0 add 2001:660:5307:3100::1/64
0000.005 ifconfig tun0 add fe80::660:5307:3100:1/64
0000.007 ifconfig tun0

tun0      Link encap:UNSPEC  HWaddr 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00
          inet adr:192.168.1.4  P-t-P:192.168.1.4  Masque:255.255.255.255
          adr inet6: 2001:660:5307:3100::1/64 Scope:Global
          adr inet6: fe80::660:5307:3100:1/64 Scope:Lien
          UP POINTOPOINT RUNNING NOARP MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 lg file transmission:500
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</pre>
</li>
<li><strong>Note 1: leave the terminal open</strong> (you don&#8217;t want to kill tunslip6, it bridges the BR to the front-end network)</li>
<li><strong>Note 2</strong>: If you have <strong>an error &#8220;overlaps with routes&#8221;</strong>, it&#8217;s because another experiment is using the same ipv6 prefix (e.g. : <strong>2001:660:5307:3100::/64</strong>).
<p>You can view currently used IPv6 prefixes on the frontend SSH with this command</p>
<pre>&lt;login&gt;@grenoble:~$ <strong>ip -6 route</strong>
2001:660:5307:30fff::/64 dev eth0  proto kernel  metric 256  mtu 1500 advmss 1440 hoplimit 4294967295
<strong>2001:660:5307:3100::/64 dev tun0  proto kernel  metric 256  mtu 1500 advmss 1440 hoplimit 4294967295</strong>
fe80::/64 dev eth1  proto kernel  metric 256  mtu 1500 advmss 1440 hoplimit 4294967295
fe80::/64 dev eth0  proto kernel  metric 256  mtu 1500 advmss 1440 hoplimit 4294967295
fe80::/64 dev tun0  proto kernel  metric 256  mtu 1500 advmss 1440 hoplimit 4294967295
default via 2001:660:5307:30ff:ff:: dev eth0  metric 1  mtu 1500 advmss 1440 hoplimit 4294967295</pre>
</li>
<li><strong>Note 3</strong>: if you did not already authenticate using <tt>iotlab-auth</tt>, do it now:
<pre>&lt;login&gt;@grenoble:~$ iotlab-auth -u login</pre>
</li>
</ul>
</li>
<li>Deploy the Border Router (BR) node on selected node using the CLI tool <tt>iotlab-node</tt>.
<pre>&lt;login&gt;@grenoble:~$ iotlab-node --update ~/iot-lab/parts/contiki/examples/ipv6/rpl-border-router/<strong>border-router.iotlab-m3</strong> -l grenoble,m3,<strong>1</strong>
{
    "0": [
        "m3-1.grenoble.iot-lab.info"
    ]
}</pre>
</li>
<li>Get the Border Router IPv6 address from tunslip output:
<pre>...
Platform starting in 1...
GO!
[in clock_init() DEBUG] Starting systick timer at 100Hz

0473.257 *** Address:2001:660:5307:3100::1 =&gt; 2001:0660:5307:3100
0473.257  Starting 'Border router process' 'Web server'Got configuration message of type P
0473.257 Setting prefix 2001:660:5307:3100::
0473.257 Server IPv6 addresses:
0473.257  <strong>2001:660:5307:3100::2354</strong>
0473.257  fe80::2354
</pre>
</li>
<li>Ping6 BR node using global address:
<pre>&lt;login&gt;@grenoble:~$ ping6 <strong>2001:660:5307:3100::2354</strong></pre>
</li>
<li>Choose one CoAP server node picking another node (here node 2). Open a new terminal and read serial port output
<pre>&lt;login&gt;@grenoble:~$ nc m3-2 20000</pre>
</li>
<li>Flash <strong>CoAP server</strong> firmware on the other nodes.
<pre>&lt;login&gt;@grenoble:~$ iotlab-node --update ~/iot-lab/parts/contiki/examples/iotlab/04-er-rest-example/<strong>er-example-server.iotlab-m3</strong> -e grenoble,m3,1
{
    "0": [
		"m3-2.grenoble.iot-lab.info",
		"m3-3.grenoble.iot-lab.info",
		"m3-4.grenoble.iot-lab.info",
		"m3-5.grenoble.iot-lab.info",
		"m3-6.grenoble.iot-lab.info",
		"m3-13.grenoble.iot-lab.info",
		"m3-287.grenoble.iot-lab.info",
		"m3-288.grenoble.iot-lab.info",
		"m3-289.grenoble.iot-lab.info"
    ]
}</pre>
<p>Let&#8217;s do the following with one CoAP server, for example m3-2. You can do the same with any other server.</li>
<li>View CoAP server starting on the serial output
<pre>&lt;login&gt;@grenoble:~$ nc m3-2 20000
Platform starting in 1... 
GO!
[in clock_init() DEBUG] Starting systick timer at 100Hz
Starting 'IoT-LAB CoAP Server'
</pre>
</li>
<li>Grab the CoAP server node&#8217;s IPv6 address from the BR&#8217;s web interface
<pre>&lt;login&gt;@grenoble:~$ lynx -dump http://[2001:660:5307:3100::2354]
Neighbors
fe80::9982
Routes
2001:660:5307:3100::9982/128 (via fe80::9982) 16711353s
</pre>
<p>Understand <a href="https://github.com/iot-lab/iot-lab/wiki/Get-M3-and-A8-M3-nodes-uid---ipv6-address-match" target="_blank">M3 nodes uid / ipv6 address match</a>.</li>
<li>Ping the CoAP server&#8217;s global address from SSH frontend
<pre>&lt;login&gt;@grenoble:~$ ping6 2001:660:5307:3100::9982</pre>
</li>
<li>For resource discovery, CoAP use the <strong>/.well-known/core</strong> path to provide resource descriptions in its <a href="https://tools.ietf.org/html/rfc6690">CoRE Link Format</a>. Send CoAP request with the <a href="https://aiocoap.readthedocs.io/en/latest/module/aiocoap.cli.client.html">aiocoap-client</a> installed on the SSH frontend:
<pre>&lt;login&gt;@grenoble:~$ <strong>aiocoap-client</strong> coap://[2001:660:5307:3100::9982]:<strong>5683/.well-known/core</strong>
&lt;/.well-known/core&gt;;ct=40,&lt;/test/hello&gt;;title="Hello world: ?len=0..";rt="Text",&lt;/test/push&gt;;title="Periodic demo";obs,&lt;/actuators/toggle&gt;;title="Red LED";rt="Control",&lt;/sensors/light&gt;;title="Ambient light (supports JSON)";rt="LightSensor",&lt;/sensors/pressure&gt;;title="Pressure (supports JSON)";rt="PressureSensor",&lt;/sensors/gyros&gt;;title="Three axis gyroscope (supports JSON)";rt="GyroscopeSensor",&lt;/sensors/accel&gt;;title="Three axis accelerometer (supports JSON)";rt="AccelerometerSensor",&lt;/sensors/magne&gt;;title="Three axis magnetometer (supports JSON)";rt="MagnetometerSensor"
</pre>
</li>
<li>Test different GET requests to the different sensors resources
<pre>&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683<strong>/sensors/light</strong>
0
&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683<strong>/sensors/pressure</strong>
992
&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683<strong>/sensors/gyros</strong>
-96;1557;-52
&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683<strong>/sensors/accel</strong>
-107;-12;-1025
&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683<strong>/sensors/magne</strong>
-75;-261;422
</pre>
</li>
<li>Test the Hello world resource with path <strong>/test/hello</strong>
<pre>&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683/test/hello
Hello World!
&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683/test/hello?len=42 # print 42 caracters
Hello World! ABCDEFGHIJKLMNOPQRSTUVWXYZabc
&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683/test/hello?len=64 # print 64 caracters
Hello World! ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxy
&lt;login&gt;@grenoble:~$ aiocoap-client coap://[2001:660:5307:3100::9982]:5683/test/hello?len=80 # print 64 caracters 
Hello World! ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxy
</pre>
<p>The last output is 64 characters too, because the REST_MAX_CHUNK_SIZE, defined in the application&#8217;s <tt>project-conf.h</tt>, is 64 bytes.</li>
<li>CoAP provides Observers support (publish/subscribe mechanism). They allow for a client to receive updates when a state changes. This reduces the need for constant polling but also introduces additional engineering overhead into the protocol when considering sleeping nodes and unreliable networks. Ther Erbium CoAP Server includes an example of <strong>PERIODIC</strong> resource, notifying each subscriber at a time interval (5 seconds) with the resource value (here a simple counter).
<pre>&lt;login&gt;@grenoble:~$ aiocoap-client <strong>--observe</strong> coap://[2001:660:5307:3100::9982]:5683<strong>/test/push</strong>
 VERY LONG EVENT 235
VERY LONG EVENT 236
VERY LONG EVENT 237
...
</pre>
<p><strong>Note : </strong>Regarding the counter value, you will understand that the server starts the periodic resource on the node at the starting of the server even if you don&#8217;t have subscribers.</li>
<li>The server also provides the support for <strong>EVENT</strong> resource. To illustrate this feature we handle an event when an input has been received from the serial port of the node and we send a CoAP response with the data input.
<ul>
<li>This resource is disabled by default, so you need to uncomment the line 159 in <tt>er-example-server.c</tt>
<pre>rest_activate_resource(&amp;res_event, "test/serial");</pre>
</li>
<li>Compile and flash this new firmware
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/04-er-rest-example$ make TARGET=iotlab-m3 &amp;&amp; iotlab-node --update -l grenoble,m3,2</pre>
</li>
<li>Observe this resource
<pre>&lt;login&gt;@grenoble:~$ aiocoap-client <strong>--observe</strong> coap://[2001:660:5307:3100::9982]:5683<strong>/test/serial</strong></pre>
</li>
<li>Each time a string is sended into the serial port, a notification is sended by the CoAP server
<pre>&lt;login&gt;@grenoble:~$ nc m3-2 20000
...
coap event # write this string and press enter
</pre>
<pre>&lt;login&gt;@grenoble:~$ aiocoap-client --observe coap://[2001:660:5307:3100::9982]:5683/test/serial
...
coap event
</pre>
</li>
</ul>
</li>
</ol>
</div>	</div><!-- .entry-content -->
	
</article><!-- #post-7399 -->


			
		</main><!-- #main -->
		
	</div><!-- #primary -->

	</div><!-- #content -->
	
</div><!-- #page -->

<footer class="site-footer" id="colophon" role="contentinfo">
	
	<div class="container">
		<div class="row">

			<div class="bottom-navigation col-sm-6 col-sm-push-6">
							</div><!-- .bottom-navigation -->
                </div><!-- .row -->

		<div class="row">
			<div class="footer-text col-sm-9">
				<a href="../../what-is-iot-lab/index.html">WHAT IS IOT-LAB?</a> <a href="../../about-us/index.html">ABOUT US</a> <a href="mailto:admin@iot-lab.info">CONTACT US</a> <a href="https://github.com/iot-lab/iot-lab/issues" target="_blank">SUPPORT</a> -<a href="https://github.com/iot-lab">GitHub</a>/<a href="https://twitter.com/FIT_IoTLAB">Twitter</a>/<a href="https://www.youtube.com/channel/UCrWBoYgLJCkMWgaJF8Hh3Og">Youtube</a>-   Copyright © FIT IoT-LAB			</div><!-- .footer-text -->
			<div class="col-sm-3">
				<a href="http://fit-equipex.fr/"><img class="fit-logo center-block" src="../../wp-content/themes/alienship-1.2.5-child/templates/parts/fit-white.svg"></a>
			</div>

		</div><!-- .row -->
	</div><!-- .container -->

	</footer><!-- #colophon -->
      <script type="text/javascript">
		
          var pfHeaderImgUrl = '';
          var pfHeaderTagline = '';
          var pfdisableClickToDel = '0';
          var pfHideImages = '0';
          var pfImageDisplayStyle = 'right';
          var pfDisableEmail = '0';
          var pfDisablePDF = '0';
          var pfDisablePrint = '0';
          var pfCustomCSS = '';
		  (function() {
            var e = document.createElement('script'); e.type="text/javascript";
		    if('https:' == document.location.protocol) {
			  js='https://pf-cdn.printfriendly.com/ssl/main.js';
		    }
		    else{
			  js='http://cdn.printfriendly.com/printfriendly.js';
		    }
            e.src = js;
            document.getElementsByTagName('head')[0].appendChild(e);
	  	  })();
      </script>
<script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"smooth_scroll":"1","visibility_show":"show","visibility_hide":"hide","width":"Auto"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/table-of-contents-plus/front6149.js?ver=1404'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5/js/bootstrap.minb12b.js?ver=3.1.1'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5/js/alienship-helper8a54.js?ver=1.0.0'></script>

</body>

<!-- Mirrored from www.iot-lab.info/tutorials/contiki-coap-m3/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jun 2020 08:21:19 GMT -->
</html>