
<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.iot-lab.info/tutorials/robots-circuit-m3/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jun 2020 08:20:47 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<!-- [if IE]> <meta http-equiv="X-UA-Compatible" content="IE=Edge"/> <! [endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="../../xmlrpc.php" />
<title>Do a circuit loop with a mobile M3 node &#8226; FIT/IoT-LAB</title>
<!--[if lt IE 9]><script src="https://www.iot-lab.info/wp-content/themes/alienship-1.2.5/js/html5shiv.js" type="text/javascript"></script><![endif]-->

<link rel="alternate" type="application/rss+xml" title="FIT/IoT-LAB &raquo; Feed" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="FIT/IoT-LAB &raquo; Comments Feed" href="../../comments/feed/index.html" />
<link rel='stylesheet' id='responsive-lightbox-swipebox-front-css'  href='../../wp-content/plugins/responsive-lightbox/assets/swipebox/source/swipebox2f54.css?ver=4.1' type='text/css' media='all' />
<link rel='stylesheet' id='toc-screen-css'  href='../../wp-content/plugins/table-of-contents-plus/screen6149.css?ver=1404' type='text/css' media='all' />
<link rel='stylesheet' id='parent-style-css'  href='../../wp-content/themes/alienship-1.2.5/style2f54.css?ver=4.1' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='../../wp-content/themes/alienship-1.2.5/css/bootstrap.minb3e8.css?ver=0.1' type='text/css' media='all' />
<link rel='stylesheet' id='alienship-style-css'  href='../../wp-content/themes/alienship-1.2.5-child/styleb3e8.css?ver=0.1' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery90f9.js?ver=1.11.1'></script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery-migrate.min1576.js?ver=1.2.1'></script>
<script type='text/javascript' src='../../wp-content/plugins/responsive-lightbox/assets/swipebox/source/jquery.swipebox.min2f54.js?ver=4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var rlArgs = {"script":"swipebox","selector":"lightbox","custom_events":"","activeGalleries":"1","animation":"1","hideBars":"1","hideBarsDelay":"5000","videoMaxWidth":"1080"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/responsive-lightbox/js/front2f54.js?ver=4.1'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5-child/js/bootstrap-hover-dropdown.min2f54.js?ver=4.1'></script>
<link rel='canonical' href='index.html' />
        <style type="text/css" media="screen">
          div.printfriendly {
            margin: 12px 12px 12px 12px;;
          }
          div.printfriendly a, div.printfriendly a:link, div.printfriendly a:visited {
            text-decoration: none;
            font-size: 14px;
            color: #6D9F00;
            vertical-align: bottom;
            border: none;
          }

          .printfriendly a:hover {
            cursor: pointer;
          }

          .printfriendly a img  {
            border: none;
            padding:0;
            margin-right: 6px;
            display:inline-block;
            box-shadow: none;
            -webkit-box-shadow: none;
            -moz-box-shadow: none;
          }
          .printfriendly a span{
            vertical-align: bottom;
          }
          .pf-alignleft {
            float: left;
          }
          .pf-alignright {
            float: right;
          }
          div.pf-aligncenter {
            display: block;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
          }
        </style>
        <style type="text/css" media="print">
          .printfriendly {
            display: none;
          }
        </style>
 	<style type="text/css">
 				#site-title,
		#site-description {
			position: absolute;
			clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
			clip: rect(1px, 1px, 1px, 1px);
		}
 		 	</style>
 	
<!-- BEGIN GADWP v5.3.1.1 Universal Analytics - https://deconf.com/google-analytics-dashboard-wordpress/ -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-115966924-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- END GADWP Universal Analytics -->
</head>

<body class="page page-id-6636 page-child parent-pageid-7210 page-template page-template-templates page-template-page-full page-template-templatespage-full-php layout-default">
	<!--[if lt IE 9]><p class="browsehappy alert alert-danger">You are using an outdated browser. Please <a class="alert-link" href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]-->

	<!-- Top Menu -->
	<nav class="navbar navbar-default navbar-onelab navbar-fixed-top top-navigation" role="navigation">
	    <div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
							<a href="../../index.html"><img src="../../wp-content/themes/alienship-1.2.5-child/templates/parts/fit-iotlab3.png" /></a>
					</div>

		<div class="collapse navbar-collapse navbar-ex1-collapse">
			<ul id="menu-topmainmenu" class="nav navbar-nav"><li id="menu-item-2066" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2066"><a title="News" href="../../news/index.html">News</a></li>
<li id="menu-item-140" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-140 dropdown"><a title="Platform" data-toggle="dropdown" data-hover="dropdown" href="../../what-is-iot-lab/index.html">Platform <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-466" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-466"><a title="What is IoT-LAB?" href="../../what-is-iot-lab/index.html">What is IoT-LAB?</a></li>
	<li id="menu-item-147" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-147"><a title="Deployment" href="../../deployment/index.html">Deployment</a></li>
	<li id="menu-item-146" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-146"><a title="Hardware" href="../../hardware/index.html">Hardware</a></li>
	<li id="menu-item-4608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4608"><a title="Robots" href="../../robots/index.html">Robots</a></li>
	<li id="menu-item-2400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2400"><a title="About us" href="../../about-us/index.html">About us</a></li>
</ul>
</li>
<li id="menu-item-1467" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1467 dropdown"><a title="Dev Center" data-toggle="dropdown" data-hover="dropdown" href="../../dev-center/index.html">Dev Center <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-1957" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1957"><a title="Software Development" href="../../dev-center/index.html">Software Development</a></li>
	<li id="menu-item-7329" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-7329"><a title="Tutorials" href="../index.html">Tutorials</a></li>
	<li id="menu-item-1552" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1552"><a title="Operating Systems" href="../../operating-systems/index.html">Operating Systems</a></li>
	<li id="menu-item-1396" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1396"><a title="Libraries" href="../../libraries/index.html">Libraries</a></li>
	<li id="menu-item-1394" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1394"><a title="Drivers" href="../../drivers/index.html">Drivers</a></li>
	<li id="menu-item-7372" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7372"><a title="REST API documentation" href="http://api.iot-lab.info/">REST API documentation</a></li>
</ul>
</li>
<li id="menu-item-3209" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3209 dropdown"><a title="Community" data-toggle="dropdown" data-hover="dropdown" href="../../community/index.html">Community <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-3244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3244"><a title="Share your experience" href="../../community/index.html">Share your experience</a></li>
	<li id="menu-item-3210" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3210"><a title="Education" href="../../education/index.html">Education</a></li>
	<li id="menu-item-2133" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2133"><a title="Publications" href="../../publications/index.html">Publications</a></li>
	<li id="menu-item-2405" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2405"><a title="Charter" href="../../charter/index.html">Charter</a></li>
</ul>
</li>
<li id="menu-item-1470" class="get_started menu-item menu-item-type-post_type menu-item-object-page menu-item-1470"><a title="Get Started" href="../../get_started/index.html">Get Started</a></li>
</ul>

			<ul class="nav navbar-nav navbar-right">

				<li class="dropdown">
					<a href="../../testbed/drawgantt.html" title="Testbed activity"><span class="glyphicon glyphicon-calendar"></span> Activity</a>
				</li>



			                        	<li><span><a href="../../testbed/index.html" class="btn btn-primary testbed" title="Login">Access the testbed</a></span></li>
			                        </ul>
		</div>
	    </div>
	</nav>
<!-- End Top Menu -->


	<div id="page" class="container hfeed site">

				<header id="masthead" class="site-header" role="banner">
			<p id="site-title" class="site-title"><a href="../../index.html" title="FIT/IoT-LAB" rel="home">FIT/IoT-LAB</a></p><p id="site-description" class="site-description">Very large scale open wireless sensor network testbed</p>		</header><!-- #masthead -->
			<div id="content" class="site-content row">

		<div id="primary" class="col-sm-12">

				<main id="main" class="site-main" role="main">

		<article role="article" id="post-6636" class="post-6636 page type-page status-publish hentry">
		<div class="entry-content">
		<div class="pf-content"><h2>Do a circuit loop with a mobile M3 node</h2>
<p><img class="alignnone size-full wp-image-1252" src="../../wp-content/uploads/2014/02/difficulty.jpg" alt="" width="30" height="30" /> <strong>Difficulty</strong>: Intermediate</p>
<p><img class="size-full wp-image-1253 alignnone" src="../../wp-content/uploads/2014/02/duration.jpg" alt="" width="30" height="30" /> <strong>Duration</strong>: 20 minutes</p>
<p><em><strong>Prerequisites</strong>: <a title="Configure your SSH access" href="../ssh-access/index.html">Configure SSH Access</a> / <a title="Experiment CLI client" href="../iotlab-experimenttools-client/index.html">Experiment CLI client</a> / <a href="../serial-aggregator/index.html">Nodes Serial Link Aggregation</a></em></p>
<p><em><strong>Description</strong>: The aim of this tutorial is to submit an experiment with a mobile M3 node and interact with it. A mobile node is a node embedded on a <a href="../../robots/index.html">robot</a> with predefined trajectories. You will book one mobile M3 node, set it up with a sample firmware file. Once the experiment running, you will interact with the firmware running on the node and graph IMU sensors values. After the experiment, you can plot the mobile node trajectory.<br />
Since robots features are not yet included in the webportal, you will use here the cli-tools.<br />
</em></p>
<h3>Launch the experiment</h3>
<ol>
<li>Choose your node:
<ul>
<li>Click on <strong>Activity</strong></li>
<li>Filter resources by choosing <strong>mobile only</strong> in the list</li>
<li>Choose a node available and<strong> keep its node id</strong></li>
<li><em><strong>Note</strong>: Try to take a node which was inactive the last two hours (to be sure to have enough battery).</em></li>
</ul>
<p><a href="../../wp-content/uploads/2016/04/drawgantt_turtlebot.png" rel="lightbox[gallery-pMPD]"><img class="aligncenter size-full wp-image-5101" src="../../wp-content/uploads/2016/04/drawgantt_turtlebot.png" alt="drawgantt_turtlebot" width="1492" height="161" /></a></li>
<li>Choose your circuit, within the list returned by <code>iotlab-robot</code>:
<pre>iotlab-robot get -l</pre>
</li>
<li>Download the <a href="../../wp-content/uploads/2014/08/simple_robot.html">simple_robot.elf</a> firmware binary for m3 nodes. For information, you can have a look at the <a href="https://github.com/iot-lab/openlab/tree/master/appli/iotlab_examples/simple_robot">firmware code</a>.</li>
<li>Submit an experiment with cli-tools, either from an SSH frontend or from your computer. In this example, we chose the <var>m3-258</var> from Lille doing the <var>square1</var> circuit:
<pre>iotlab-experiment submit -d 20 -n simple_robot_tutorial -l lille,m3,258,simple_robot.elf,mobility=square1</pre>
<p>Or you may also let the scheduler choose the node just by describing node properties:</p>
<pre>iotlab-experiment submit -d 20 -n simple_robot_tutorial -l 1,archi=m3:at86rf231+mobile=1+site=lille,simple_robot.elf,mobility=square1</pre>
<p>You get an experiment id.</li>
</ol>
<h3>Interact during experiment</h3>
<ol>
<li>In a terminal on your computer, give access as a tcp socket (explanation in Advanced usage section of <a href="../serial-aggregator/index.html">Nodes Serial Link Aggregation tutorial</a>) :
<pre class="code bash">socat tcp-listen:20000,fork,reuseaddr "exec:ssh &lt;login&gt;@&lt;site&gt;.iot-lab.info 'serial_aggregator'"</pre>
</li>
<li>In another terminal on your computer, download the <a href="https://raw.githubusercontent.com/iot-lab/openlab/master/appli/iotlab_examples/simple_robot/live_imu.py">live_imu.py</a> script from our <a href="https://github.com/iot-lab/openlab/tree/master/appli/iotlab_examples/simple_robot">Openlab repository on GitHub</a>.<br />
<strong>Note</strong>: you need to have a working Python with <strong>Matplotlib</strong> installed.</li>
<li>Launch the script with the following parameters. Use the right TCP <code>port</code> configured with socat before. Use the right <code>nodeid</code> (e.g. m3-258) in order to filter incoming traffic from the serial_aggregator. Avalaible values for the <code>sensor</code> option are <em>Gyr</em> (gyrometer), <em>Acc</em> (accelerometer), <em>Mag</em> (magnetometer).
<pre class="code bash">python ./live_imu.py --port 20000 --sensor Gyr --nodeid m3-258</pre>
<p><img class="aligncenter size-full wp-image-5096" src="../../wp-content/uploads/2016/04/mobile_live_imu.png" alt="mobile_live_imu" width="800" height="600" /></li>
<li>Close the trajectory plot and stop the socat command with <em>Ctrl-C</em>.</li>
</ol>
<h3>Mobile node&#8217;s trajectory</h3>
<ol>
<li>Stop your experiment
<pre>iotlab-experiment stop</pre>
</li>
<li>Connect to the SSH fronted of Lille with <strong>X11 forwarding</strong>
<pre>ssh <strong>-X</strong> &lt;login&gt;@lille.iot-lab.info</pre>
</li>
<li>The mobile node trajectory is copied <strong>at the end of the experiment</strong> in your home folder in .oml files.
<pre>&lt;login&gt;@lille:~$ <strong>less ~/.iot-lab/&lt;experiment id&gt;/robot/m3-258.oml</strong>
protocol: 4
domain: 39738
start-time: 1459778452
sender-id: m3-258
app-name: robot_position_measures
schema: 0 _experiment_metadata subject:string key:string value:string
schema: 10 robot_pose timestamp_s:uint32 timestamp_us:uint32 x:double y:double theta:double
content: text

10.298170       10      1       1459778462      878753  2.526062        0.129655        -1.563731
10.398204       10      2       1459778462      978787  2.526062        0.129655        -1.563731
10.498178       10      3       1459778463      078761  2.526062        0.129655        -1.563731
....
</pre>
<h4>Trajectory Measure Table</h4>
<table class="table table-striped">
<thead>
<tr>
<td><strong>Measure</strong></td>
<td><strong>Unit</strong></td>
</tr>
</thead>
<tbody>
<tr>
<td>x, y<br />
z<br />
th</td>
<td>meters, cartesian coordinates<br />
meters, altitude which is a constant<br />
radians, orientation around z axis</td>
</tr>
</tbody>
</table>
</li>
<li>Plot your file using the <code>oml_plot_tools</code>:
<pre>&lt;login&gt;@lille:~$ <strong>plot_oml_traj -i ~/.iot-lab/&lt;experiment id&gt;/robot/m3-258.oml</strong></pre>
<p>You can use <code>--circuit-name</code> and <code>--circuit-file</code> options to observe the mobile node trajectory respectively with the planned circuit and the site map.</li>
</ol>
<div class="row">
<div class="col-sm-4">
<div class="thumbnail">
<p><a href="../../wp-content/uploads/2016/04/plot_traj_1.png" rel="lightbox[gallery-pMPD]"><img class="aligncenter size-thumbnail wp-image-5097" src="../../wp-content/uploads/2016/04/plot_traj_1-150x150.png" alt="plot_traj_1" width="150" height="150" /></a></p>
<div class="caption"><em>Full plot of the mobile node trajectory</em></div>
</div>
</div>
<div class="col-sm-4">
<div class="thumbnail">
<p><a href="../../wp-content/uploads/2016/04/plot_traj_2.png" rel="lightbox[gallery-pMPD]"><img class="aligncenter size-thumbnail wp-image-5098" src="../../wp-content/uploads/2016/04/plot_traj_2-150x150.png" alt="plot_traj_2" width="150" height="150" /></a></p>
<div class="caption"><em>Plot of the mobile node trajectory with planned circuit representation</em></div>
</div>
</div>
<div class="col-sm-4">
<div class="thumbnail">
<p><a href="../../wp-content/uploads/2016/04/plot_traj_3.png" rel="lightbox[gallery-pMPD]"><img class="aligncenter size-thumbnail wp-image-5099" src="../../wp-content/uploads/2016/04/plot_traj_3-150x150.png" alt="plot_traj_3" width="150" height="150" /></a></p>
<div class="caption"><em>Plot of the mobile node trajectory included into site map</em></div>
</div>
</div>
</div>
<p>&nbsp;<br />
&nbsp;<br />
&nbsp;</p>
<div class="alert alert-info">
<h3>Additional details</h3>
<p>During an experiment, a mobile node follows a trajectory chosen by the user (see step 2). Some details about the robots and<br />
the trajectories for each site can be found on <a href="https://github.com/iot-lab/iot-lab/wiki/Turtlebot2-mobile-node" target="_blank"> the GitHub wiki</a>.</p>
<p>The <code>iotlab-robot</code> tool is the dedicated client to get the status of a robot or get and update mobilities. See the <a href="../iotlab-robottools-client/index.html">dedicated tutorial</a> for more information.</p>
<p>It is also possible to visualize the robot trajectory in 3D using Gazebo on your PC workstation. For details, see <a href="https://github.com/iot-lab/iot-lab/blob/master/gazebo-view/README.md" target="_blank">the GitHub wiki</a>.</p>
</div>
</div>	</div><!-- .entry-content -->
	
</article><!-- #post-6636 -->


			
		</main><!-- #main -->
		
	</div><!-- #primary -->

	</div><!-- #content -->
	
</div><!-- #page -->

<footer class="site-footer" id="colophon" role="contentinfo">
	
	<div class="container">
		<div class="row">

			<div class="bottom-navigation col-sm-6 col-sm-push-6">
							</div><!-- .bottom-navigation -->
                </div><!-- .row -->

		<div class="row">
			<div class="footer-text col-sm-9">
				<a href="../../what-is-iot-lab/index.html">WHAT IS IOT-LAB?</a> <a href="../../about-us/index.html">ABOUT US</a> <a href="mailto:admin@iot-lab.info">CONTACT US</a> <a href="https://github.com/iot-lab/iot-lab/issues" target="_blank">SUPPORT</a> -<a href="https://github.com/iot-lab">GitHub</a>/<a href="https://twitter.com/FIT_IoTLAB">Twitter</a>/<a href="https://www.youtube.com/channel/UCrWBoYgLJCkMWgaJF8Hh3Og">Youtube</a>-   Copyright © FIT IoT-LAB			</div><!-- .footer-text -->
			<div class="col-sm-3">
				<a href="http://fit-equipex.fr/"><img class="fit-logo center-block" src="../../wp-content/themes/alienship-1.2.5-child/templates/parts/fit-white.svg"></a>
			</div>

		</div><!-- .row -->
	</div><!-- .container -->

	</footer><!-- #colophon -->
      <script type="text/javascript">
		
          var pfHeaderImgUrl = '';
          var pfHeaderTagline = '';
          var pfdisableClickToDel = '0';
          var pfHideImages = '0';
          var pfImageDisplayStyle = 'right';
          var pfDisableEmail = '0';
          var pfDisablePDF = '0';
          var pfDisablePrint = '0';
          var pfCustomCSS = '';
		  (function() {
            var e = document.createElement('script'); e.type="text/javascript";
		    if('https:' == document.location.protocol) {
			  js='https://pf-cdn.printfriendly.com/ssl/main.js';
		    }
		    else{
			  js='http://cdn.printfriendly.com/printfriendly.js';
		    }
            e.src = js;
            document.getElementsByTagName('head')[0].appendChild(e);
	  	  })();
      </script>
<script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"smooth_scroll":"1","visibility_show":"show","visibility_hide":"hide","width":"Auto"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/table-of-contents-plus/front6149.js?ver=1404'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5/js/bootstrap.minb12b.js?ver=3.1.1'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5/js/alienship-helper8a54.js?ver=1.0.0'></script>

</body>

<!-- Mirrored from www.iot-lab.info/tutorials/robots-circuit-m3/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jun 2020 08:20:57 GMT -->
</html>