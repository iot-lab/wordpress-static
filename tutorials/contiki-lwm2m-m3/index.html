
<!DOCTYPE html>
<html lang="en-US">

<!-- Mirrored from www.iot-lab.info/tutorials/contiki-lwm2m-m3/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jun 2020 08:21:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<!-- [if IE]> <meta http-equiv="X-UA-Compatible" content="IE=Edge"/> <! [endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="pingback" href="../../xmlrpc.php" />
<title>LWM2M client with public IPv6 network and M3 nodes &#8226; FIT/IoT-LAB</title>
<!--[if lt IE 9]><script src="https://www.iot-lab.info/wp-content/themes/alienship-1.2.5/js/html5shiv.js" type="text/javascript"></script><![endif]-->

<link rel="alternate" type="application/rss+xml" title="FIT/IoT-LAB &raquo; Feed" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="FIT/IoT-LAB &raquo; Comments Feed" href="../../comments/feed/index.html" />
<link rel='stylesheet' id='responsive-lightbox-swipebox-front-css'  href='../../wp-content/plugins/responsive-lightbox/assets/swipebox/source/swipebox2f54.css?ver=4.1' type='text/css' media='all' />
<link rel='stylesheet' id='toc-screen-css'  href='../../wp-content/plugins/table-of-contents-plus/screen6149.css?ver=1404' type='text/css' media='all' />
<link rel='stylesheet' id='parent-style-css'  href='../../wp-content/themes/alienship-1.2.5/style2f54.css?ver=4.1' type='text/css' media='all' />
<link rel='stylesheet' id='bootstrap-css'  href='../../wp-content/themes/alienship-1.2.5/css/bootstrap.minb3e8.css?ver=0.1' type='text/css' media='all' />
<link rel='stylesheet' id='alienship-style-css'  href='../../wp-content/themes/alienship-1.2.5-child/styleb3e8.css?ver=0.1' type='text/css' media='all' />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery90f9.js?ver=1.11.1'></script>
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery-migrate.min1576.js?ver=1.2.1'></script>
<script type='text/javascript' src='../../wp-content/plugins/responsive-lightbox/assets/swipebox/source/jquery.swipebox.min2f54.js?ver=4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var rlArgs = {"script":"swipebox","selector":"lightbox","custom_events":"","activeGalleries":"1","animation":"1","hideBars":"1","hideBarsDelay":"5000","videoMaxWidth":"1080"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/responsive-lightbox/js/front2f54.js?ver=4.1'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5-child/js/bootstrap-hover-dropdown.min2f54.js?ver=4.1'></script>
<link rel='canonical' href='index.html' />
        <style type="text/css" media="screen">
          div.printfriendly {
            margin: 12px 12px 12px 12px;;
          }
          div.printfriendly a, div.printfriendly a:link, div.printfriendly a:visited {
            text-decoration: none;
            font-size: 14px;
            color: #6D9F00;
            vertical-align: bottom;
            border: none;
          }

          .printfriendly a:hover {
            cursor: pointer;
          }

          .printfriendly a img  {
            border: none;
            padding:0;
            margin-right: 6px;
            display:inline-block;
            box-shadow: none;
            -webkit-box-shadow: none;
            -moz-box-shadow: none;
          }
          .printfriendly a span{
            vertical-align: bottom;
          }
          .pf-alignleft {
            float: left;
          }
          .pf-alignright {
            float: right;
          }
          div.pf-aligncenter {
            display: block;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
          }
        </style>
        <style type="text/css" media="print">
          .printfriendly {
            display: none;
          }
        </style>
 	<style type="text/css">
 				#site-title,
		#site-description {
			position: absolute;
			clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
			clip: rect(1px, 1px, 1px, 1px);
		}
 		 	</style>
 	
<!-- BEGIN GADWP v5.3.1.1 Universal Analytics - https://deconf.com/google-analytics-dashboard-wordpress/ -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-115966924-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- END GADWP Universal Analytics -->
</head>

<body class="page page-id-6478 page-child parent-pageid-7210 page-template-default layout-1c">
	<!--[if lt IE 9]><p class="browsehappy alert alert-danger">You are using an outdated browser. Please <a class="alert-link" href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]-->

	<!-- Top Menu -->
	<nav class="navbar navbar-default navbar-onelab navbar-fixed-top top-navigation" role="navigation">
	    <div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
							<a href="../../index.html"><img src="../../wp-content/themes/alienship-1.2.5-child/templates/parts/fit-iotlab3.png" /></a>
					</div>

		<div class="collapse navbar-collapse navbar-ex1-collapse">
			<ul id="menu-topmainmenu" class="nav navbar-nav"><li id="menu-item-2066" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2066"><a title="News" href="../../news/index.html">News</a></li>
<li id="menu-item-140" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-140 dropdown"><a title="Platform" data-toggle="dropdown" data-hover="dropdown" href="../../what-is-iot-lab/index.html">Platform <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-466" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-466"><a title="What is IoT-LAB?" href="../../what-is-iot-lab/index.html">What is IoT-LAB?</a></li>
	<li id="menu-item-147" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-147"><a title="Deployment" href="../../deployment/index.html">Deployment</a></li>
	<li id="menu-item-146" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-146"><a title="Hardware" href="../../hardware/index.html">Hardware</a></li>
	<li id="menu-item-4608" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4608"><a title="Robots" href="../../robots/index.html">Robots</a></li>
	<li id="menu-item-2400" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2400"><a title="About us" href="../../about-us/index.html">About us</a></li>
</ul>
</li>
<li id="menu-item-1467" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-1467 dropdown"><a title="Dev Center" data-toggle="dropdown" data-hover="dropdown" href="../../dev-center/index.html">Dev Center <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-1957" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1957"><a title="Software Development" href="../../dev-center/index.html">Software Development</a></li>
	<li id="menu-item-7329" class="menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-7329"><a title="Tutorials" href="../index.html">Tutorials</a></li>
	<li id="menu-item-1552" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1552"><a title="Operating Systems" href="../../operating-systems/index.html">Operating Systems</a></li>
	<li id="menu-item-1396" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1396"><a title="Libraries" href="../../libraries/index.html">Libraries</a></li>
	<li id="menu-item-1394" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1394"><a title="Drivers" href="../../drivers/index.html">Drivers</a></li>
	<li id="menu-item-7372" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7372"><a title="REST API documentation" href="http://api.iot-lab.info/">REST API documentation</a></li>
</ul>
</li>
<li id="menu-item-3209" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3209 dropdown"><a title="Community" data-toggle="dropdown" data-hover="dropdown" href="../../community/index.html">Community <span class="caret"></span></a>
<ul role="menu" class=" dropdown-menu">
	<li id="menu-item-3244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3244"><a title="Share your experience" href="../../community/index.html">Share your experience</a></li>
	<li id="menu-item-3210" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3210"><a title="Education" href="../../education/index.html">Education</a></li>
	<li id="menu-item-2133" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2133"><a title="Publications" href="../../publications/index.html">Publications</a></li>
	<li id="menu-item-2405" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2405"><a title="Charter" href="../../charter/index.html">Charter</a></li>
</ul>
</li>
<li id="menu-item-1470" class="get_started menu-item menu-item-type-post_type menu-item-object-page menu-item-1470"><a title="Get Started" href="../../get_started/index.html">Get Started</a></li>
</ul>

			<ul class="nav navbar-nav navbar-right">

				<li class="dropdown">
					<a href="../../testbed/drawgantt.html" title="Testbed activity"><span class="glyphicon glyphicon-calendar"></span> Activity</a>
				</li>



			                        	<li><span><a href="../../testbed/index.html" class="btn btn-primary testbed" title="Login">Access the testbed</a></span></li>
			                        </ul>
		</div>
	    </div>
	</nav>
<!-- End Top Menu -->


	<div id="page" class="container hfeed site">

				<header id="masthead" class="site-header" role="banner">
			<p id="site-title" class="site-title"><a href="../../index.html" title="FIT/IoT-LAB" rel="home">FIT/IoT-LAB</a></p><p id="site-description" class="site-description">Very large scale open wireless sensor network testbed</p>		</header><!-- #masthead -->
			<div id="content" class="site-content row">

	
	<div id="primary" class="content-area col-sm-8">

				<main id="main" class="site-main" role="main">

			<article role="article" id="post-6478" class="post-6478 page type-page status-publish hentry">
		<div class="entry-content">
		<div class="pf-content"><h2>Use LWM2M running on top of a RPL network and M3 nodes</h2>
<p>&nbsp;</p>
<p><img class="alignnone size-full wp-image-1252" src="../../wp-content/uploads/2014/02/difficulty.jpg" alt="" width="30" height="30" /> <strong>Difficulty</strong>: High</p>
<p><img class="size-full wp-image-1253 alignnone" src="../../wp-content/uploads/2014/02/duration.jpg" alt="" width="30" height="30" /> <strong>Duration</strong>: 60 minutes</p>
<p><em><strong>Prerequisites</strong>: <a title="Configure your SSH access" href="../ssh-access/index.html" target="_blank">Configure SSH Access</a> / </em><em><a href="../understand-ipv6-subnetting-on-the-fit-iot-lab-testbed/index.html" target="_blank">Understand IPv6 subnetting</a> / </em><a title="Get and compile firmware for M3 and A8-M3 nodes" href="../contiki-compilation/index.html">Get and compile firmware for M3 and A8-M3 nodes</a> / <a title="Public IPv6 (6LoWPAN/RPL) network with M3 nodes" href="../contiki-public-ipv6-m3/index.html">Public IPv6 (6LoWPAN/RPL) network with M3 nodes</a></p>
<p><em><strong>Description</strong>: The aim of this tutorial is to discover the basics of OMA Lightweight M2M Protocol. You will reserve some M3 nodes on the Grenoble site, set them up with flashing LwM2M client firmware, and create a simple IPv6 network in IoT-LAB. After LwM2M client nodes will register with Leshan Eclispe server and you can understand Object resources model and data.</em></p>
<p>&nbsp;</p>
<h2>LwM2M overview</h2>
<p>The LwM2M protocol was specified by industry experts in the Device Management Working Group at the Open Mobile Alliance (OMA). LwM2M is a secure, efficient and deployable client-server protocol for managing resource constrained devices. LwM2M uses architectural design based on REST, defines an extensible resource and data model and builds on data transfer standard called the Constrained Application Protocol (CoAP), standardized by the Internet Engineering Taskforce (IETF)</p>
<p><a href="../../wp-content/uploads/2018/03/leshan-overview.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow size-medium wp-image-6578" src="../../wp-content/uploads/2018/03/leshan-overview-264x300.png" alt="leshan-overview" width="264" height="300" /></a></p>
<h2><span id="Book_and_configure_the_LoRa_node">Book and configure LwM2M nodes</span></h2>
<p>&nbsp;</p>
<ol>
<li>Connect to a site&#8217;s SSH frontend
<pre>my_computer$ <strong>ssh &lt;login&gt;@grenoble.iot-lab.info</strong></pre>
</li>
<li>Setup the contiki repository
<pre>&lt;login&gt;@grenoble:~$ <strong>git clone https://github.com/iot-lab/iot-lab.git
</strong>&lt;login&gt;@grenoble:~$ <strong>cd iot-lab</strong>
&lt;login&gt;@grenoble:~$ <strong>make setup-contiki
</strong>&lt;login&gt;@grenoble:~$ <strong>cd parts/contiki/</strong></pre>
</li>
<li>If it is not alreay done, set your credentials for CLI tools with:
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki$<strong> iotlab-auth -u &lt;login&gt;</strong></pre>
</li>
<li>Submit a new experiment:
<ul>
<li>Duration: <strong>60 minutes</strong></li>
<li>Choose ten nodes: Archi = m3:at86rf231 / Site = grenoble / Number = 10</li>
</ul>
<p>Use this command with CLI tools:</p>
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki$ <strong>iotlab-experiment submit -n lwm2m -d 60 -l 10,archi=m3:at86rf231+site=grenoble</strong></pre>
</li>
<li>Wait for your experiment to be running:
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki$ <strong>iotlab-experiment wait</strong></pre>
</li>
<li>Get the list of nodes of your experiments:
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki$ <strong>iotlab-experiment get -r</strong>
{
 "items": [
 {
 ...
 "network_address": "<strong>m3-105</strong>.grenoble.iot-lab.info",
 "uid": "b576", 
 ...</pre>
<p>Pick one node that will be later used as Border Router and write down its <var>ID</var> and <var>UID</var> (e.g. m3-105 and b576).</li>
<li>Choose an <a href="../understand-ipv6-subnetting-on-the-fit-iot-lab-testbed/index.html" target="_blank">available IPv6 prefix</a> for the site you are experimenting on. For example in Grenoble testbed :
<ul>
<li>we choose <strong>2001:660:5307:3100::/64</strong></li>
</ul>
</li>
<li>Launch tunslip6:
<pre>&lt;login&gt;@grenoble:~$ <strong>sudo tunslip6.py -v2 -L -a m3-105 -p 20000 2001:660:5307:3100::1/64</strong></pre>
<p><strong>Note</strong>: If you have an <strong>error &#8220;overlaps with routes&#8221;</strong>, it&#8217;s because another experiment is using the same ipv6 prefix (e.g. : <tt>2001:660:5307:3100::/64</tt>).</p>
<p>You can view ipv6 prefix used on the frontend SSH with this command and choose another prefix .</p>
<pre>&lt;login&gt;@grenoble:~$ <strong>ip -6 route</strong>
<strong>2001:660:5307:3100::/64 dev tun0</strong>  proto kernel  metric 256 
fe80::/64 dev eth1  proto kernel  metric 256  
fe80::/64 dev eth0  proto kernel  metric 256</pre>
</li>
<li>Program your BR node
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki$ <strong>cd examples/ipv6/rpl-border-router</strong> 
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/ipv6/rpl-border-router$ <strong>make TARGET=iotlab-m3</strong>
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/ipv6/rpl-border-router$ <strong>iotlab-node -up border-router.iotlab-m3 -l grenoble,m3,105</strong></pre>
</li>
<li>From another terminal, ping the Border Router:You can view the border router ipv6 address in the <strong>tunslip6 shell</strong>
<pre>0750.128 Platform starting in 1... 
0750.129 GO!
0750.129 [in clock_init() DEBUG] Starting systick timer at 100Hz
0750.131 
0750.131 *** Address:2001:660:5307:3100::1 =&gt; 2001:0660:5307:3100
0750.173  Starting 'Border router process' 'Web server'Got configuration message of type P
0750.173 Setting prefix 2001:660:5307:3100::
0751.130 Server IPv6 addresses:
0751.130  <strong>2001:660:5307:3100::b576</strong>
0751.131  fe80::b576
</pre>
<pre>&lt;login&gt;@grenoble:~$ <strong>ping6 2001:660:5307:3100::b576</strong></pre>
</li>
<li>Choose one LwM2M client node picking another node (here node 108 and uid 8477). Open a new terminal and read serial port output
<pre>&lt;login&gt;@grenoble:~$ <strong>nc m3-108 20000</strong></pre>
</li>
<li>Program your LwM2M client nodes (iotlab-node -e option = flash firmware except BR node)
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki$ <strong>cd examples/iotlab/07-lwm2m-example</strong>
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example$ <strong>make TARGET=iotlab-m3</strong>
&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example$ <strong>iotlab-node -up lwm2m-example-client.iotlab-m3 -e grenoble,m3,105</strong></pre>
</li>
<li>Get the list of neighbors and links from the Border Router:
<pre>&lt;login&gt;@grenoble:~$ <strong>lynx -dump http://[2001:660:5307:3100::b576]</strong>
 Neighbors
fe80::a775
fe80::9382
fe80::b179
fe80::b468
fe80::9881
fe80::1062
fe80::a770
<strong>fe80::8477</strong>

   Routes
2001:660:5307:3100::b468/128 (via fe80::b468) 1666s
2001:660:5307:3100::1062/128 (via fe80::1062) 1601s
2001:660:5307:3100::a770/128 (via fe80::a770) 1494s
2001:660:5307:3100::a775/128 (via fe80::a775) 1485s
2001:660:5307:3100::9382/128 (via fe80::9382) 1408s
2001:660:5307:3100::b179/128 (via fe80::b179) 1152s
2001:660:5307:3100::9881/128 (via fe80::9881) 816s
<strong>2001:660:5307:3100::8477</strong>/128 (via fe80::8477) 813s
</pre>
</li>
<li>Ping6 LwM2M client node:
<pre>&lt;login&gt;@grenoble:~$ ping6 <strong>2001:660:5307:3100::8477</strong></pre>
</li>
<li>Verify on the serial port output that the LwM2M client has registered with the LwM2M server (eg. Eclipse Leshan)
<pre>&lt;login&gt;@grenoble:~$ <strong>nc m3-108 20000</strong>
Platform starting in 1... 
GO!
[in clock_init() DEBUG] Starting systick timer at 100Hz
 Starting 'IoT-LAB LWM2M client example'
RD Client started with endpoint '?ep=<strong>M3000000008477</strong>'
<strong>Registering</strong> with [<strong>2001:660:5307:3200::2</strong>]:5683 lwm2m endpoint '?ep=<strong>M3000000008477</strong>': '<strong>&lt;3/0&gt;,&lt;3303/0&gt;,&lt;3311/0&gt;,&lt;3313/0&gt;,&lt;3314/0&gt;,&lt;3334/0&gt;,&lt;3341/0&gt;</strong>'</pre>
</li>
</ol>
<h2>LwM2M server and objects resources model</h2>
<ol>
<li>Go to <a href="http://leshan.iot-lab.info/">Leshan server web interface</a> and visualize the clients list. You can view all LwM2M client nodes with a client endpoint like <strong><strong>M300000000&lt;uid&gt;</strong></strong><a href="../../wp-content/uploads/2018/03/leshan-registration.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow wp-image-6547 " src="../../wp-content/uploads/2018/03/leshan-registration.png" alt="" width="628" height="283" /></a></li>
<li>Select one client and visualize the instance tab. You shoud get two attributes like &#8220;Manufacturer&#8221; and &#8220;Model Number&#8221; with Read button.<a href="../../wp-content/uploads/2018/03/leshan-instance.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow wp-image-6545 " src="../../wp-content/uploads/2018/03/leshan-instance.png" alt="" width="610" height="167" /></a>These parameters are mapping in the firmware with Contiki project-conf.h file variables
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example$ cat project-conf.h
//////////LWM2M DEVICE//////////////

#ifndef LWM2M_DEVICE_MANUFACTURER
#define LWM2M_DEVICE_MANUFACTURER "IoT-LAB"
#endif

#ifndef LWM2M_DEVICE_TYPE
#define LWM2M_DEVICE_TYPE "STM32F103REY"
#endif

#ifndef LWM2M_DEVICE_MODEL_NUMBER
#define LWM2M_DEVICE_MODEL_NUMBER "M3"
#endif
</pre>
</li>
<li>LwM2M objects/resources are accessed with simple URIs: <strong>/{Object ID}/{Object Instance}/{Resource ID}</strong>. For example with temperature <a href="../../wp-content/uploads/2018/03/temperature-uri.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow wp-image-6590 size-full" src="../../wp-content/uploads/2018/03/temperature-uri.png" alt="" width="417" height="187" /></a>The LwM2M technical specification itself defines eight objects; the <a href="https://github.com/IPSO-Alliance/pub">repository</a> contains many more contributed by IPSO alliance, oneM2M, and from vendors. You can view the temperature object <a href="https://github.com/IPSO-Alliance/pub/blob/master/reg/xml/3303.xml">XML definition</a> here and view the table below:<a href="../../wp-content/uploads/2018/03/temperature-resource.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow wp-image-6594 " src="../../wp-content/uploads/2018/03/temperature-resource.png" alt="" width="595" height="287" /></a>Go to temperature object tab and read resources on Leshan interface. You can also use observe instead of read request on the sensor value resource and it will be update automatically every 30 seconds. Whenever the state of a resource changes, the client notifies each server registered as observer for the resource.<a href="../../wp-content/uploads/2018/03/leshan-temperature.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow wp-image-6549 " src="../../wp-content/uploads/2018/03/leshan-temperature.png" alt="" width="579" height="166" /></a>Indeed in the firmware code you should see a timer which handle temperature object notification
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example$ cat lwm2m-example-client.c
  etimer_set(&amp;timer, CLOCK_SECOND *30);

  while(1) {
    PROCESS_WAIT_EVENT();
    if (ev == PROCESS_EVENT_TIMER) {
      /* Call the temperature object handler */
      object_temperature_handle();
      etimer_restart(&amp;timer);
    }
</pre>
<p>Moreover you should visualize the IPSO temperature object definition in the source code with the handle method</p>
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example/ipso-objects$ cat obj-temperature.c
/*---------------------------------------------------------------------------*/
LWM2M_RESOURCES(temperature_resources,
                /* Temperature (Current) */
                LWM2M_RESOURCE_CALLBACK(5700, { temp, NULL, NULL }),
                /* Min Range Value */
                LWM2M_RESOURCE_FLOATFIX(5603, TEMPERATURE_MIN),
                /* Max Range Value */
                LWM2M_RESOURCE_FLOATFIX(5604, TEMPERATURE_MAX),
                /* Units */
                LWM2M_RESOURCE_STRING(5701, "Cel"),
                );
LWM2M_INSTANCES(temperature_instances,
                LWM2M_INSTANCE(0, temperature_resources));
LWM2M_OBJECT(temperature, 3303, temperature_instances);
/*---------------------------------------------------------------------------*/

void
object_temperature_handle(void)
{
  printf("Notify observer temperature sensor\n");
  lwm2m_object_notify_observers(&amp;temperature, "/0/5700");
}
</pre>
</li>
<li>Go to leds object tab in leshan interface. Try ro read resources Colour (Green by default) and sensor units. If you see the object <a href="https://github.com/IPSO-Alliance/pub/blob/master/reg/xml/3311.xml">XML definition</a> you can see that the resource Colour is in read/write mode. So choose Colour (Red or Blue) and try to write the resource.View the source code of leds object and understand how you can write the On/Off resource.<a href="../../wp-content/uploads/2018/03/leshan-leds.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow wp-image-6546 " src="../../wp-content/uploads/2018/03/leshan-leds.png" alt="" width="580" height="319" /></a>
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example/ipso-objects$ cat obj-leds-control.c
/*---------------------------------------------------------------------------*/
LWM2M_RESOURCES(leds_control_resources,
                LWM2M_RESOURCE_CALLBACK(5850, { read_state, write_state, NULL }),
                LWM2M_RESOURCE_CALLBACK(5706, { read_color, write_color, NULL }),
                /* Units */
                LWM2M_RESOURCE_STRING(5701, "Lux"),
                );
LWM2M_INSTANCES(leds_control_instances,
                LWM2M_INSTANCE(0, leds_control_resources));
LWM2M_OBJECT(leds_control, 3311, leds_control_instances);

/*---------------------------------------------------------------------------*/
</pre>
</li>
<li>You can test the last object tab with &#8220;Addressable Text Display&#8221; object. The idea is to interact with the serial port of the LwM2M client node. For this purpose you must find the node name which corresponding to client endpoint. In this example we use client M3000000008477 (eg. m3-108). Firstly you can read &#8220;Text&#8221; resource on leshan web interface and verify that you have no serial input. After write on the serial port of the node &#8220;Hello World!&#8221; and read again &#8220;Text&#8221; resource to see the update value in leshan interface
<pre>&lt;login&gt;@grenoble:~$ <strong>nc m3-108 20000</strong>
Hello World!
</pre>
<p>Next try observe button and write on serial port to verify that the &#8220;Text&#8221; resource is updated automatically. Finally use Write button in leshan interface and visualize that your string is print on serial port</p>
<p><a href="../../wp-content/uploads/2018/03/leshan-serial.png" rel="lightbox[gallery-Opgw]"><img class="aligncenter image-shadow wp-image-6548 " src="../../wp-content/uploads/2018/03/leshan-serial.png" alt="" width="580" height="193" /></a></p>
<p>View in the source code the serial event handler and the &#8220;Addressable Text Display&#8221; object to understand the behaviour.</p>
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example$ cat lwm2m-example-client.c
while(1) {
    PROCESS_WAIT_EVENT();
    ...
    if(ev == serial_line_event_message) {
      obj_serial_data = (char*)data;
      /* Call the serial object handler */
      object_serial_handle();
    }
</pre>
<pre>&lt;login&gt;@grenoble:~/iot-lab/parts/contiki/examples/iotlab/07-lwm2m-example/ipso-objects$ cat obj-serial.c
/*---------------------------------------------------------------------------*/
LWM2M_RESOURCES(serial_resources,
                /* serial text */
                LWM2M_RESOURCE_CALLBACK(5527, { read_serial, write_serial, NULL }),
                );
LWM2M_INSTANCES(serial_instances,
                LWM2M_INSTANCE(0, serial_resources));
LWM2M_OBJECT(serial, 3341, serial_instances);
/*---------------------------------------------------------------------------*/

void
object_serial_handle(void)
{
  printf("Notify observer serial sensor\n");
  lwm2m_object_notify_observers(&amp;serial, "/0/5527");
}
</pre>
</li>
</ol>
<p>Congratulations you have finished the tutorial!!!!</p>
</div>	</div><!-- .entry-content -->
	
</article><!-- #post-6478 -->


			
		</main><!-- #main -->
		
	</div><!-- #primary -->

	</div><!-- #content -->
	
</div><!-- #page -->

<footer class="site-footer" id="colophon" role="contentinfo">
	
	<div class="container">
		<div class="row">

			<div class="bottom-navigation col-sm-6 col-sm-push-6">
							</div><!-- .bottom-navigation -->
                </div><!-- .row -->

		<div class="row">
			<div class="footer-text col-sm-9">
				<a href="../../what-is-iot-lab/index.html">WHAT IS IOT-LAB?</a> <a href="../../about-us/index.html">ABOUT US</a> <a href="mailto:admin@iot-lab.info">CONTACT US</a> <a href="https://github.com/iot-lab/iot-lab/issues" target="_blank">SUPPORT</a> -<a href="https://github.com/iot-lab">GitHub</a>/<a href="https://twitter.com/FIT_IoTLAB">Twitter</a>/<a href="https://www.youtube.com/channel/UCrWBoYgLJCkMWgaJF8Hh3Og">Youtube</a>-   Copyright © FIT IoT-LAB			</div><!-- .footer-text -->
			<div class="col-sm-3">
				<a href="http://fit-equipex.fr/"><img class="fit-logo center-block" src="../../wp-content/themes/alienship-1.2.5-child/templates/parts/fit-white.svg"></a>
			</div>

		</div><!-- .row -->
	</div><!-- .container -->

	</footer><!-- #colophon -->
      <script type="text/javascript">
		
          var pfHeaderImgUrl = '';
          var pfHeaderTagline = '';
          var pfdisableClickToDel = '0';
          var pfHideImages = '0';
          var pfImageDisplayStyle = 'right';
          var pfDisableEmail = '0';
          var pfDisablePDF = '0';
          var pfDisablePrint = '0';
          var pfCustomCSS = '';
		  (function() {
            var e = document.createElement('script'); e.type="text/javascript";
		    if('https:' == document.location.protocol) {
			  js='https://pf-cdn.printfriendly.com/ssl/main.js';
		    }
		    else{
			  js='http://cdn.printfriendly.com/printfriendly.js';
		    }
            e.src = js;
            document.getElementsByTagName('head')[0].appendChild(e);
	  	  })();
      </script>
<script type='text/javascript'>
/* <![CDATA[ */
var tocplus = {"smooth_scroll":"1","visibility_show":"show","visibility_hide":"hide","width":"Auto"};
/* ]]> */
</script>
<script type='text/javascript' src='../../wp-content/plugins/table-of-contents-plus/front6149.js?ver=1404'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5/js/bootstrap.minb12b.js?ver=3.1.1'></script>
<script type='text/javascript' src='../../wp-content/themes/alienship-1.2.5/js/alienship-helper8a54.js?ver=1.0.0'></script>

</body>

<!-- Mirrored from www.iot-lab.info/tutorials/contiki-lwm2m-m3/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Jun 2020 08:21:28 GMT -->
</html>